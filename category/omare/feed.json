{
    "version": "https://jsonfeed.org/version/1",
    "title": "欢迎 • All posts by \"omare\" category",
    "description": "DESS, THU",
    "home_page_url": "https://ningchenhui.github.io",
    "items": [
        {
            "id": "https://ningchenhui.github.io/ESM/OMARE/omareInstall/",
            "url": "https://ningchenhui.github.io/ESM/OMARE/omareInstall/",
            "title": "JASMIN & NEMO 安装（新）",
            "date_published": "2023-09-12T10:19:13.000Z",
            "content_html": "<p>JASMIN &amp; NEMO Installation (new)<span id=\"more\"></span></p>\n<h1 id=\"所用平台\"><a class=\"markdownIt-Anchor\" href=\"#所用平台\">#</a> 所用平台</h1>\n<p>系统：Fedora 38 Workstation Edition 64 位<br>\n GCC 13.2.1 （Red Hat）</p>\n<h1 id=\"gcc-485\"><a class=\"markdownIt-Anchor\" href=\"#gcc-485\">#</a> GCC 4.8.5</h1>\n<p><span class=\"label info\"><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0hleXhrL2djYy00LjguNS1maXhlZA==\">下载地址</span></span></p>\n<p><span class=\"label info\"><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jb29rYnl0ZS5uZXQvcG9zdC9jb21waWxlLWdjYy1vbi1saW51eC8=\">参考</span></span></p>\n<h2 id=\"依赖安装\"><a class=\"markdownIt-Anchor\" href=\"#依赖安装\">#</a> 依赖安装</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> yum <span class=\"token function\">install</span> glibc-devel.i686 libstdc++-devel.i686 libstdc++-devel.x86_64 </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">sudo</span> yum <span class=\"token function\">install</span> libstdc++-static glibc-static gcc-c++</pre></td></tr></table></figure><p>在源码文件夹中  <code>./contrib/download_prerequisites</code>  可下载好 mpfr-2.4.2，mpc-0.8.1，gmp-4.3.2，此外还需下载 isl-0.11.1，cloog-0.18.0 并解压到源码文件夹。</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> gcc-4.8.5</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>./contrib/download_prerequisites</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">wget</span> https://gcc.gnu.org/pub/gcc/infrastructure/isl-0.11.1.tar.bz2</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">wget</span> https://gcc.gnu.org/pub/gcc/infrastructure/cloog-0.18.1.tar.gz</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">tar</span> -jxvf isl-0.11.1.tar.bz2</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">tar</span> -zxvf cloog-0.18.1.tar.gz</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">mv</span> isl-0.11.1 isl</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">mv</span> cloog-0.18.1 cloog</pre></td></tr></table></figure><h2 id=\"正常安装\"><a class=\"markdownIt-Anchor\" href=\"#正常安装\">#</a> 正常安装</h2>\n<p>为了防止出错<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNDgxMTQwODcvY29tcGlsaW5nLWdjYy00LTgtNQ==\">在源码文件夹外</span>编译安装。不指定  <code>enable-language</code>  时默认安装所有语言，但会有库缺失，可能编译不通过。</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>```bash</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">cd</span> <span class=\"token punctuation\">..</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">mkdir</span> gccbuild</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">cd</span> gccbuild</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">..</span>/gcc-4.8.5/configure --prefix<span class=\"token operator\">=</span>/usr/local/gcc-4.8.5 --enable-languages<span class=\"token operator\">=</span>c,c++,fortran </pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">make</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">make</span> check</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">make</span> <span class=\"token function\">install</span></pre></td></tr></table></figure><p><span class=\"label info\"><span class=\"exturl\" data-url=\"aHR0cDovL25vdGVzLm1heHdpLmNvbS8yMDE3LzEyLzA5L2dudS1nY2MtY29tcGlsZS1mb3ItY2VudG9zNi8=\">参考</span></span></p>\n<h2 id=\"错误处理\"><a class=\"markdownIt-Anchor\" href=\"#错误处理\">#</a> 错误处理</h2>\n<p>用高版本 GCC 编译会出现很多不兼容问题。此版本已修复大部分问题。</p>\n<h3 id=\"bool-spill_indirect_levels-类型错误\"><a class=\"markdownIt-Anchor\" href=\"#bool-spill_indirect_levels-类型错误\">#</a>  <code>bool spill_indirect_levels</code>  类型错误</h3>\n<p>修改  <code>x_spill_indirect_levels</code>  类型为  <code>unsigned char</code> .</p>\n<p><span class=\"label info\"><span class=\"exturl\" data-url=\"aHR0cHM6Ly9nY2MuZ251Lm9yZy9waXBlcm1haWwvZ2NjLXBhdGNoZXMvMjAyMy1BdWd1c3QvNjI3MjQzLmh0bWw=\">参考</span></span></p>\n<h1 id=\"gdb-92\"><a class=\"markdownIt-Anchor\" href=\"#gdb-92\">#</a> GDB 9.2</h1>\n<p>由于使用旧版 gcc 时系统 gdb 不可用，需重新编译安装旧版 gdb。</p>\n<p><span class=\"label info\"><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuc291cmNld2FyZS5vcmcvZ2RiL2Rvd25sb2FkLw==\">下载地址</span></span></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">install</span> texinfo <span class=\"token operator\">!</span>编译gdb手册用</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">tar</span> zxvf  gdb-9.2.tar.gz</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">cd</span> gdb-9.2</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">mkdir</span> build</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token builtin class-name\">cd</span> build</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">..</span>/configure --disable-host-shared --prefix<span class=\"token operator\">=</span>/usr/local/gdb-9.2</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">make</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">make</span> <span class=\"token function\">install</span></pre></td></tr></table></figure><h2 id=\"错误处理-2\"><a class=\"markdownIt-Anchor\" href=\"#错误处理-2\">#</a> 错误处理</h2>\n<h3 id=\"error-please-include-configh-first\"><a class=\"markdownIt-Anchor\" href=\"#error-please-include-configh-first\">#</a> #error “Please include config.h first.”</h3>\n<p>nat/amd64-linux-siginfo.c: Include “gdbsupport/common-defs.h” (which in turn includes &lt;gnulib/config.h&gt;) before include of &lt;signal.h&gt;.</p>\n<p><span class=\"label info\"><span class=\"exturl\" data-url=\"aHR0cHM6Ly9zb3VyY2V3YXJlLm9yZy9naXQvP3A9YmludXRpbHMtZ2RiLmdpdDthPWNvbW1pdDtoPTg0ODhjMzU3Y2U0ZmMzMDlkNDljN2IwMjI0Y2Y5NTc0YjY4ZTgxMTY=\">参考</span></span></p>\n<h1 id=\"jasmin-452\"><a class=\"markdownIt-Anchor\" href=\"#jasmin-452\">#</a> JASMIN 4.5.2</h1>\n<p>官网：<span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5jYWVwLXNjbnMuYWMuY24vSkFTTUlOLnBocA==\">中物院高性能数值模拟软件中心 JASMIN</span>，可申请安装包。<br>\n获得安装包后，执行  <code>sh jasmin4-4.5.2-Linux-x86_64.sh</code> ，按提示操作。<br>\n建议以版本名作为安装文件夹，如  <code>/home/ning/jasmin-4.5.2</code> ，不选择自动更新环境变量，在下文中统一设置。<br>\n在使用 JASMIN 时需更新项目  <code>CMakeLists.txt</code>  的路径，可参考 <a href=\"/ESM/OMARE/omare220205/\">OMARE 学习使用（一）</a>。</p>\n<h1 id=\"netcdf-44\"><a class=\"markdownIt-Anchor\" href=\"#netcdf-44\">#</a> Netcdf 4.4</h1>\n<p><span class=\"label info\"><span class=\"exturl\" data-url=\"ZnRwOi8vZnRwLnVuaWRhdGEudWNhci5lZHUvcHViL25ldGNkZi9uZXRjZGYtNC8=\">下载地址</span></span><br>\nroot 登录，启用 GCC 4.8.5 后 <em>→参考本页环境变量配置</em></p>\n<h2 id=\"zlib-128\"><a class=\"markdownIt-Anchor\" href=\"#zlib-128\">#</a> zlib 1.2.8</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tar</span> -zxvf zlib-1.2.8.tar.gz</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">cd</span> zlib-1.2.8</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>./configure --prefix<span class=\"token operator\">=</span>/usr/local/netcdf</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">make</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">make</span> check</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">make</span> <span class=\"token function\">install</span></pre></td></tr></table></figure><h2 id=\"hdf5-1813\"><a class=\"markdownIt-Anchor\" href=\"#hdf5-1813\">#</a> hdf5 1.8.13</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tar</span> -zxvf hdf5-1.8.13.tar.gz</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">cd</span> hdf5-1.8.13</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>./configure --prefix<span class=\"token operator\">=</span>/usr/local/netcdf --with-zlib<span class=\"token operator\">=</span>/usr/local/netcdf/ --enable-shared --enable-parallel </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">make</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">make</span> check</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">make</span> <span class=\"token function\">install</span></pre></td></tr></table></figure><h2 id=\"netcdf-432\"><a class=\"markdownIt-Anchor\" href=\"#netcdf-432\">#</a> netcdf 4.3.2</h2>\n<p>修改 <code>libsrc4/nc4file.c</code> ，参考<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL1VuaWRhdGEvbmV0Y2RmLWMvY29tbWl0LzQzNWQ4YTAzZWQyOGJiNWFkNjNhZmYxMmNiYzZhYjkxNTMxYjZiYzg=\">这里</span>。</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tar</span> -zxvf netcdf-4.3.2.tar.gz</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">cd</span> netcdf-4.3.2</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token assign-left variable\">CPPFLAGS</span><span class=\"token operator\">=</span>-I<span class=\"token string\">'/usr/local/netcdf/include -I/home/ning/jasmin-4.5.2/include'</span> <span class=\"token assign-left variable\">LDFLAGS</span><span class=\"token operator\">=</span>-L/usr/local/netcdf/lib   ./configure --prefix<span class=\"token operator\">=</span>/usr/local/netcdf --disable-dap --enable-parallel-tests </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">make</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">make</span> check</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">make</span> <span class=\"token function\">install</span></pre></td></tr></table></figure><h2 id=\"netcdf-fortran-440\"><a class=\"markdownIt-Anchor\" href=\"#netcdf-fortran-440\">#</a> netcdf-fortran 4.4.0</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">LD_LIBRARY_PATH</span><span class=\"token operator\">=</span>/usr/local/netcdf/lib:<span class=\"token variable\">$LD_LIBRARY_PATH</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">tar</span> -zxvf netcdf-fortran-4.4.0.tar.gz</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">cd</span> netcdf-fortran-4.4.0</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token assign-left variable\">CPPFLAGS</span><span class=\"token operator\">=</span><span class=\"token string\">'-I/usr/local/netcdf/include -I/home/ning/jasmin-4.5.2/include'</span> <span class=\"token assign-left variable\">LDFLAGS</span><span class=\"token operator\">=</span>-L/usr/local/netcdf/lib ./configure --prefix<span class=\"token operator\">=</span>/usr/local/netcdf --enable-parallel-tests</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">make</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">make</span> check</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">make</span> <span class=\"token function\">install</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">make</span> check</pre></td></tr></table></figure><p>第一次 check 可能因找不到库报错，install 后 check 通过。</p>\n<p><span class=\"label info\"><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NjaHVtYWNoZXIyMDE2L2FydGljbGUvZGV0YWlscy84MDg1MDI0MA==\">参考</span></span></p>\n<h1 id=\"nemo\"><a class=\"markdownIt-Anchor\" href=\"#nemo\">#</a> Nemo</h1>\n<h2 id=\"xios\"><a class=\"markdownIt-Anchor\" href=\"#xios\">#</a> xios</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>svn checkout  http://forge.ipsl.jussieu.fr/ioserver/svn/XIOS/branchs/xios-2.0 xios-2.0</pre></td></tr></table></figure><p>Then modify files  <code>arch-GCC_LINUX.*</code>  in  <code>arch</code> , add the  <code>-ldl</code>  flag to  <code>HDF5_LIB</code>  in  <code>arch-GCC_local.path</code>  if build hdf5 library as a not shareable. Remove  <code>-lcurl</code>  flag. Check the used hdf5 version.</p>\n<p>The  <code>boost_dir</code>  and  <code>OASIS_dir</code>  are not necessary, just leave them.</p>\n<p>Finally, run</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./make_xios --arch GCC_local</pre></td></tr></table></figure><h2 id=\"nemo-2\"><a class=\"markdownIt-Anchor\" href=\"#nemo-2\">#</a> Nemo</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>svn checkout https://forge.ipsl.jussieu.fr/nemo/svn/NEMO/releases/release-4.0 nemo4.0</pre></td></tr></table></figure><p>Copy and rename an configuration file as  <code>arch-gfortran_local.fcm</code>  from an architecture similar to our own. Set the following variables:</p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>%NCDF_HOME    &#x2F;usr&#x2F;local&#x2F;path&#x2F;to&#x2F;netcdf</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>%HDF5_HOME    &#x2F;usr&#x2F;local&#x2F;path&#x2F;to&#x2F;hdf5</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>%XIOS_HOME    &#x2F;home&#x2F;$( whoami )&#x2F;path&#x2F;to&#x2F;xios-trunk</pre></td></tr></table></figure><p>Compile a reference configuration:</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./makenemo -m <span class=\"token string\">'gfortran_local'</span> -n <span class=\"token string\">'NW2'</span> -r <span class=\"token string\">'ORCA2_ICE_PISCES'</span> del_key <span class=\"token string\">'key_top key_nosignedzero'</span> -j20</pre></td></tr></table></figure><h1 id=\"环境变量配置\"><a class=\"markdownIt-Anchor\" href=\"#环境变量配置\">#</a> 环境变量配置</h1>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>.workenv</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token string\">\"/usr/local/gcc-4.8.5/bin:<span class=\"token environment constant\">$PATH</span>\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">LD_LIBRARY_PATH</span><span class=\"token operator\">=</span>/usr/local/gcc-4.8.5/lib64:<span class=\"token variable\">$LD_LIBRARY_PATH</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token string\">\"/usr/local/gdb-9.2/bin:<span class=\"token environment constant\">$PATH</span>\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">LD_LIBRARY_PATH</span><span class=\"token operator\">=</span>/usr/local/gdb-9.2/lib:<span class=\"token variable\">$LD_LIBRARY_PATH</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">NETCDF</span><span class=\"token operator\">=</span>/usr/local/netcdf</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token variable\">$NETCDF</span>/bin:<span class=\"token environment constant\">$PATH</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">LD_LIBRARY_PATH</span><span class=\"token operator\">=</span><span class=\"token variable\">$NETCDF</span>/lib:<span class=\"token variable\">$LD_LIBRARY_PATH</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token assign-left variable\">CPPFLAGS</span><span class=\"token operator\">=</span><span class=\"token string\">'-I/usr/local/netcdf/include'</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">LDFLAGS</span><span class=\"token operator\">=</span><span class=\"token string\">'-L/usr/local/netcdf/lib'</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token string\">\"/home/ning/jasmin-4.5.2/bin:<span class=\"token environment constant\">$PATH</span>\"</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">'Env var loaded.'</span></pre></td></tr></table></figure><p>使用 Jasmin 前执行  <code>source .workenv</code> 。</p>\n<p>若在  <code>.bashrc</code>  中设置 gcc 变量会导致系统启动失败无法进入登录界面（ <code>F2</code>  可看到系统加载失败信息），此时需要用 Linux 系统安装 U 盘启动新系统（不安装！可在 Fedora 官网下载 U 盘写入工具）后挂载本机磁盘文件系统，修改  <code>GCC-4.8.5</code>  文件夹路径，删除  <code>.bashrc</code>  中新增的路径及  <code>/etc/ld.so.conf</code>  新增的路径，这时可以进入登录界面。移走  <code>/etc/ld.so.cache</code>  重置  <code>ldconfig</code> 。</p>\n<p>若反复卡死在登录界面可按  <code>ctrl+alt+F2</code>  命令行登入，删除追加的环境变量。在  <code>.bashrc</code>  中设置 Netcdf 的  <code>LD_LIBRARY_PATH</code>  会导致这种情况。</p>\n<h1 id=\"其他\"><a class=\"markdownIt-Anchor\" href=\"#其他\">#</a> 其他</h1>\n<h2 id=\"samba-文件共享服务-root\"><a class=\"markdownIt-Anchor\" href=\"#samba-文件共享服务-root\">#</a> samba 文件共享服务 (root)</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9kb2NzLmZlZG9yYXByb2plY3Qub3JnL2VuLVVTL3F1aWNrLWRvY3Mvc2FtYmEv\">官方手册: How to create a Samba share</span></p>\n<p>ifconfig 查看 samba 服务 ip<br>\n 比如  <code>180.170.100.21</code> <br>\n 在 mac 访达中访问服务器  <code>smb://180.170.100.21</code> <br>\n 在 Windows 运行中访问服务器  <code>\\\\180.170.100.21</code></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NDEwNzMwL2FydGljbGUvZGV0YWlscy84MDUwMDkyMA==\">其他参考: Samba 服务器超详细安装、配置</span></p>\n<ul>\n<li>服务管理  <code>service smb stop/start/restart</code></li>\n<li>状态查看  <code>sudo smbstatus</code></li>\n</ul>\n<h2 id=\"matlab\"><a class=\"markdownIt-Anchor\" href=\"#matlab\">#</a> matlab</h2>\n<p>安装时图形化窗口打不开，需查看 ./bin/glnxa64/MATLABWindow 缺失的库<br>\n sudo rm /bin/glnx64/libfreetype.so*</p>\n<p><span class=\"label info\"><span class=\"exturl\" data-url=\"aHR0cHM6Ly93dzIubWF0aHdvcmtzLmNuL21hdGxhYmNlbnRyYWwvYW5zd2Vycy8xODgwOTQ3LXN0ZC1ydW50aW1lX2Vycm9yLXVuZGVmaW5lZC1zeW1ib2wtZnRfZ2dldF90cmFuc2Zvcm0=\">参考</span></span></p>\n<h2 id=\"zsh\"><a class=\"markdownIt-Anchor\" href=\"#zsh\">#</a> zsh</h2>\n<p><span class=\"label info\"><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8zNDU1NTkwOTc=\">参考</span></span></p>\n<p>p10k 需要安装对应字体。</p>\n",
            "tags": [
                "Memo"
            ]
        },
        {
            "id": "https://ningchenhui.github.io/ESM/OMARE/NW2SBC/",
            "url": "https://ningchenhui.github.io/ESM/OMARE/NW2SBC/",
            "title": "NW2 initial & surface boundary condition",
            "date_published": "2023-06-16T12:47:52.000Z",
            "content_html": "<p>NeverWorld2 初始状态与边界条件 <span id=\"more\"></span></p>\n<h1 id=\"initial-condition\"><a class=\"markdownIt-Anchor\" href=\"#initial-condition\">#</a> Initial condition</h1>\n<h2 id=\"ocean\"><a class=\"markdownIt-Anchor\" href=\"#ocean\">#</a> Ocean</h2>\n<h3 id=\"temperature\"><a class=\"markdownIt-Anchor\" href=\"#temperature\">#</a> Temperature</h3>\n<p>The initial temperature is a function of both latitude (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding=\"application/x-tex\">\\phi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">ϕ</span></span></span></span>, in radians) and ocean depth (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span></span></span>, in meters). The surface temperature <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>S</mi><msup><mi>T</mi><mo>∗</mo></msup><mo stretchy=\"false\">(</mo><mi>ϕ</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">SST^*(\\phi)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.688696em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">ϕ</span><span class=\"mclose\">)</span></span></span></span> is defined as a piecewise cubic function that interpolates between the values (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>) -1.033, 28.3, and -30°C at latitudes (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding=\"application/x-tex\">\\phi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">ϕ</span></span></span></span>) -67.803, -2.803, and 137.197, respectively. The initial temperature is defined as a function of the surface temperature and depth, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>T</mi><mo>∗</mo></msup><mo stretchy=\"false\">(</mo><mi>z</mi><mo separator=\"true\">,</mo><mi>ϕ</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">T^*(z,\\phi)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.688696em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">ϕ</span><span class=\"mclose\">)</span></span></span></span>, which is defined as</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>T</mi><mo>∗</mo></msup><mo stretchy=\"false\">(</mo><mi>z</mi><mo separator=\"true\">,</mo><mi>ϕ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>16</mn><mo>−</mo><mn>12</mn><mo>⋅</mo><mi>tanh</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mfrac><mrow><mi>z</mi><mo>−</mo><mn>400</mn></mrow><mn>700</mn></mfrac><mo fence=\"true\">)</mo></mrow><mo>⋅</mo><mfrac><mrow><mn>1</mn><mo>−</mo><mi>tanh</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mfrac><mrow><mn>500</mn><mo>−</mo><mi>z</mi></mrow><mn>150</mn></mfrac><mo fence=\"true\">)</mo></mrow></mrow><mn>2</mn></mfrac><mo>⋅</mo><mfrac><mrow><mn>1</mn><mo>−</mo><msup><mrow><mo fence=\"true\">(</mo><mfrac><mi>ϕ</mi><mn>75</mn></mfrac><mo fence=\"true\">)</mo></mrow><mn>2</mn></msup></mrow><mn>0.75</mn></mfrac><mo>+</mo><mrow><mo fence=\"true\">(</mo><mn>15</mn><mo>⋅</mo><mrow><mo fence=\"true\">(</mo><mn>1</mn><mo>−</mo><mi>tanh</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mfrac><mrow><mi>z</mi><mo>−</mo><mn>50</mn></mrow><mn>1500</mn></mfrac><mo fence=\"true\">)</mo></mrow><mo fence=\"true\">)</mo></mrow><mo>−</mo><mn>1.4</mn><mo>⋅</mo><mi>tanh</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mfrac><mrow><mi>z</mi><mo>−</mo><mn>100</mn></mrow><mn>100</mn></mfrac><mo fence=\"true\">)</mo></mrow><mo>+</mo><mfrac><mrow><mn>7</mn><mo>⋅</mo><mo stretchy=\"false\">(</mo><mn>1500</mn><mo>−</mo><mi>z</mi><mo stretchy=\"false\">)</mo></mrow><mn>1500</mn></mfrac><mo fence=\"true\">)</mo></mrow><mo>⋅</mo><mfrac><mrow><mi>S</mi><mi>S</mi><msup><mi>T</mi><mo>∗</mo></msup><mo stretchy=\"false\">(</mo><mi>ϕ</mi><mo stretchy=\"false\">)</mo></mrow><mn>23.5</mn></mfrac><mo>⋅</mo><mfrac><mrow><mn>1</mn><mo>−</mo><mi>tanh</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mfrac><mrow><mi>z</mi><mo>−</mo><mn>500</mn></mrow><mn>150</mn></mfrac><mo fence=\"true\">)</mo></mrow></mrow><mn>2</mn></mfrac><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">T^*(z,\\phi) = 16 - 12 \\cdot \\tanh\\left(\\frac{z-400}{700}\\right) \\cdot \\frac{1-\\tanh\\left(\\frac{500-z}{150}\\right)}{2} \\cdot \\frac{1-\\left(\\frac{\\phi}{75}\\right)^2}{0.75} + \\left(15 \\cdot \\left(1-\\tanh\\left(\\frac{z-50}{1500}\\right)\\right) - 1.4 \\cdot \\tanh\\left(\\frac{z-100}{100}\\right) + \\frac{7 \\cdot (1500-z)}{1500}\\right) \\cdot \\frac{SST^*(\\phi)}{23.5} \\cdot \\frac{1-\\tanh\\left(\\frac{z-500}{150}\\right)}{2}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.688696em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">ϕ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span class=\"mord\">1</span><span class=\"mord\">6</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.20001em;vertical-align:-0.35001em;\"></span><span class=\"mop\">tanh</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.845108em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">7</span><span class=\"mord mtight\">0</span><span class=\"mord mtight\">0</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.04398em;\">z</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">4</span><span class=\"mord mtight\">0</span><span class=\"mord mtight\">0</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.655em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.31em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.6125em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mbin mtight\">−</span><span class=\"mop mtight\"><span class=\"mtight\">t</span><span class=\"mtight\">a</span><span class=\"mtight\">n</span><span class=\"mtight\">h</span></span><span class=\"minner mtight\"><span class=\"mopen sizing reset-size3 size6 mtight delimcenter\" style=\"top:0.07500000000000001em;\"><span class=\"mtight\">(</span></span><span class=\"mord mtight\"><span class=\"mopen nulldelimiter sizing reset-size3 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8443142857142857em;\"><span style=\"top:-2.656em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mord mtight\">5</span><span class=\"mord mtight\">0</span></span></span></span><span style=\"top:-3.2255000000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line mtight\" style=\"border-bottom-width:0.049em;\"></span></span><span style=\"top:-3.384em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">5</span><span class=\"mord mtight\">0</span><span class=\"mord mtight\">0</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.04398em;\">z</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.344em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size3 size6\"></span></span><span class=\"mclose sizing reset-size3 size6 mtight delimcenter\" style=\"top:0.07500000000000001em;\"><span class=\"mtight\">)</span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.7302199999999999em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.38522em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">0</span><span class=\"mord mtight\">.</span><span class=\"mord mtight\">7</span><span class=\"mord mtight\">5</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.6125em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mbin mtight\">−</span><span class=\"minner mtight\"><span class=\"minner mtight\"><span class=\"mopen sizing reset-size3 size6 mtight delimcenter\" style=\"top:0.07500000000000001em;\"><span class=\"mtight\">(</span></span><span class=\"mord mtight\"><span class=\"mopen nulldelimiter sizing reset-size3 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9584142857142857em;\"><span style=\"top:-2.656em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">7</span><span class=\"mord mtight\">5</span></span></span></span><span style=\"top:-3.2255000000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line mtight\" style=\"border-bottom-width:0.049em;\"></span></span><span style=\"top:-3.4623857142857144em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ϕ</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.344em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size3 size6\"></span></span><span class=\"mclose sizing reset-size3 size6 mtight delimcenter\" style=\"top:0.07500000000000001em;\"><span class=\"mtight\">)</span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1038857142857144em;\"><span style=\"top:-3.1435714285714287em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.80002em;vertical-align:-0.65002em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">(</span></span><span class=\"mord\">1</span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mop\">tanh</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.845108em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mord mtight\">5</span><span class=\"mord mtight\">0</span><span class=\"mord mtight\">0</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.04398em;\">z</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">5</span><span class=\"mord mtight\">0</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">)</span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">1</span><span class=\"mord\">.</span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mop\">tanh</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.845108em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mord mtight\">0</span><span class=\"mord mtight\">0</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.04398em;\">z</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mord mtight\">0</span><span class=\"mord mtight\">0</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.01em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mord mtight\">5</span><span class=\"mord mtight\">0</span><span class=\"mord mtight\">0</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.485em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">7</span><span class=\"mbin mtight\">⋅</span><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">1</span><span class=\"mord mtight\">5</span><span class=\"mord mtight\">0</span><span class=\"mord mtight\">0</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.04398em;\">z</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.3643399999999999em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.01934em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span><span class=\"mord mtight\">3</span><span class=\"mord mtight\">.</span><span class=\"mord mtight\">5</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.485em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7633428571428571em;\"><span style=\"top:-2.931em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">ϕ</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.655em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.31em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.6125em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mbin mtight\">−</span><span class=\"mop mtight\"><span class=\"mtight\">t</span><span class=\"mtight\">a</span><span class=\"mtight\">n</span><span class=\"mtight\">h</span></span><span class=\"minner mtight\"><span class=\"mopen sizing reset-size3 size6 mtight delimcenter\" style=\"top:0.07500000000000001em;\"><span class=\"mtight\">(</span></span><span class=\"mord mtight\"><span class=\"mopen nulldelimiter sizing reset-size3 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8443142857142857em;\"><span style=\"top:-2.656em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mord mtight\">5</span><span class=\"mord mtight\">0</span></span></span></span><span style=\"top:-3.2255000000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line mtight\" style=\"border-bottom-width:0.049em;\"></span></span><span style=\"top:-3.384em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.04398em;\">z</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">5</span><span class=\"mord mtight\">0</span><span class=\"mord mtight\">0</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.344em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size3 size6\"></span></span><span class=\"mclose sizing reset-size3 size6 mtight delimcenter\" style=\"top:0.07500000000000001em;\"><span class=\"mtight\">)</span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\">.</span></span></span></span></p>\n<p>where <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>S</mi><msup><mi>T</mi><mo>∗</mo></msup><mo stretchy=\"false\">(</mo><mi>ϕ</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">SST^*(\\phi)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.688696em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">ϕ</span><span class=\"mclose\">)</span></span></span></span> is the surface temperature defined above.</p>\n<div class=\"media-container\"><div class=\"player\" data-type=\"video\" data-src='[{\"name\":\"Temperature\",\"url\":\"temp.mp4\",\"artist\":\"NeverWorld2\"}]'></div></div>\n<h3 id=\"salinity\"><a class=\"markdownIt-Anchor\" href=\"#salinity\">#</a> Salinity</h3>\n<p>The initial salinity is uniform at each layer and defined as a function of depth, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>S</mi><mo>∗</mo></msup><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">S^*(z)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.688696em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mclose\">)</span></span></span></span>, which is defined as</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>S</mi><mo>∗</mo></msup><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>34.8</mn><mo>+</mo><mo stretchy=\"false\">(</mo><mn>0.55</mn><mo>+</mo><mn>1.25</mn><mfrac><mrow><mn>5000</mn><mo>−</mo><mi>z</mi></mrow><mn>5000</mn></mfrac><mo>−</mo><mn>1.62</mn><mi>tanh</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mfrac><mrow><mi>z</mi><mo>−</mo><mn>60</mn></mrow><mn>650</mn></mfrac><mo fence=\"true\">)</mo></mrow><mo>+</mo><mn>0.2</mn><mi>tanh</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mfrac><mrow><mi>z</mi><mo>−</mo><mn>35</mn></mrow><mn>100</mn></mfrac><mo fence=\"true\">)</mo></mrow><mo>+</mo><mn>0.2</mn><mi>tanh</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mfrac><mrow><mi>z</mi><mo>−</mo><mn>1000</mn></mrow><mn>5000</mn></mfrac><mo fence=\"true\">)</mo></mrow><mo stretchy=\"false\">)</mo><mo>⋅</mo><mfrac><mn>0.2</mn><mn>1.84</mn></mfrac><mo>⋅</mo><mfrac><mrow><mn>1</mn><mo>−</mo><mi>tanh</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mfrac><mrow><mi>z</mi><mo>−</mo><mn>500</mn></mrow><mn>150</mn></mfrac><mo fence=\"true\">)</mo></mrow></mrow><mn>2</mn></mfrac><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">S^*(z) = 34.8 + (0.55 + 1.25 \\frac{5000-z}{5000} - 1.62 \\tanh\\left(\\frac{z-60}{650}\\right) + 0.2 \\tanh\\left(\\frac{z-35}{100}\\right) + 0.2 \\tanh\\left(\\frac{z-1000}{5000}\\right)) \\cdot \\frac{0.2}{1.84} \\cdot \\frac{1-\\tanh\\left(\\frac{z-500}{150}\\right)}{2}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.688696em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span class=\"mord\">3</span><span class=\"mord\">4</span><span class=\"mord\">.</span><span class=\"mord\">8</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">5</span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.190108em;vertical-align:-0.345em;\"></span><span class=\"mord\">1</span><span class=\"mord\">.</span><span class=\"mord\">2</span><span class=\"mord\">5</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.845108em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">5</span><span class=\"mord mtight\">0</span><span class=\"mord mtight\">0</span><span class=\"mord mtight\">0</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">5</span><span class=\"mord mtight\">0</span><span class=\"mord mtight\">0</span><span class=\"mord mtight\">0</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.04398em;\">z</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.20001em;vertical-align:-0.35001em;\"></span><span class=\"mord\">1</span><span class=\"mord\">.</span><span class=\"mord\">6</span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">tanh</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.845108em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">6</span><span class=\"mord mtight\">5</span><span class=\"mord mtight\">0</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.04398em;\">z</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">6</span><span class=\"mord mtight\">0</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.20001em;vertical-align:-0.35001em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">tanh</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.845108em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mord mtight\">0</span><span class=\"mord mtight\">0</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.04398em;\">z</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">3</span><span class=\"mord mtight\">5</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.20001em;vertical-align:-0.35001em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">tanh</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.845108em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">5</span><span class=\"mord mtight\">0</span><span class=\"mord mtight\">0</span><span class=\"mord mtight\">0</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.04398em;\">z</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mord mtight\">0</span><span class=\"mord mtight\">0</span><span class=\"mord mtight\">0</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">)</span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.190108em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.845108em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mord mtight\">.</span><span class=\"mord mtight\">8</span><span class=\"mord mtight\">4</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">0</span><span class=\"mord mtight\">.</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.655em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.31em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.6125em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mbin mtight\">−</span><span class=\"mop mtight\"><span class=\"mtight\">t</span><span class=\"mtight\">a</span><span class=\"mtight\">n</span><span class=\"mtight\">h</span></span><span class=\"minner mtight\"><span class=\"mopen sizing reset-size3 size6 mtight delimcenter\" style=\"top:0.07500000000000001em;\"><span class=\"mtight\">(</span></span><span class=\"mord mtight\"><span class=\"mopen nulldelimiter sizing reset-size3 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8443142857142857em;\"><span style=\"top:-2.656em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mord mtight\">5</span><span class=\"mord mtight\">0</span></span></span></span><span style=\"top:-3.2255000000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line mtight\" style=\"border-bottom-width:0.049em;\"></span></span><span style=\"top:-3.384em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.04398em;\">z</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">5</span><span class=\"mord mtight\">0</span><span class=\"mord mtight\">0</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.344em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size3 size6\"></span></span><span class=\"mclose sizing reset-size3 size6 mtight delimcenter\" style=\"top:0.07500000000000001em;\"><span class=\"mtight\">)</span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\">.</span></span></span></span></p>\n<p><img data-src=\"salinity.png\" alt=\"Salinity\"></p>\n<h2 id=\"ice\"><a class=\"markdownIt-Anchor\" href=\"#ice\">#</a> Ice</h2>\n<p>There is no ice in the initial condition.</p>\n<h1 id=\"surface-boundary-condition\"><a class=\"markdownIt-Anchor\" href=\"#surface-boundary-condition\">#</a> Surface boundary condition</h1>\n<h2 id=\"ocean-2\"><a class=\"markdownIt-Anchor\" href=\"#ocean-2\">#</a> Ocean</h2>\n<h3 id=\"wind-stress\"><a class=\"markdownIt-Anchor\" href=\"#wind-stress\">#</a> Wind stress</h3>\n<p>The wind stress is purely zonal. We construct the wind stress from piecewise cubic functions that interpolate between the values (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>) -0.05, 0.2, -0.1, -0.02, -0.1, 0.1, and 0 Pa at latitudes (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding=\"application/x-tex\">\\phi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">ϕ</span></span></span></span>) -75, -45, -15, 0, 15, 45, and 70, respectively.<br>\nThen we add a seasonal cycle to the wind stress, which are<br>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϕ</mi><mi>t</mi></msub><mo>=</mo><mi>ϕ</mi><mo>+</mo><mn>3</mn><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>2</mn><mi>π</mi><mi>t</mi><mo>−</mo><mn>0.79</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\phi_t=\\phi+3\\cos(2\\pi t-0.79)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϕ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">ϕ</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">7</span><span class=\"mord\">9</span><span class=\"mclose\">)</span></span></span></span>, where <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.61508em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span> is the time in years (normalized between 0 and 1 within the year) and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub><mo>=</mo><mi>y</mi><mi mathvariant=\"normal\">/</mi><mn>144</mn><mo>∗</mo><mo stretchy=\"false\">(</mo><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>2</mn><mi>π</mi><mi>t</mi><mo>−</mo><mn>0.79</mn><mo stretchy=\"false\">)</mo><mo>+</mo><mn>12</mn><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">y_t=y/144*(\\cos(2\\pi t-0.79)+12)^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord\">/</span><span class=\"mord\">1</span><span class=\"mord\">4</span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">7</span><span class=\"mord\">9</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mord\">2</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></p>\n<div class=\"media-container\"><div class=\"player\" data-type=\"video\" data-src='[{\"name\":\"Wind stress\",\"url\":\"tau.mp4\",\"artist\":\"NeverWorld2\"}]'></div></div>\n<h3 id=\"heat-flux\"><a class=\"markdownIt-Anchor\" href=\"#heat-flux\">#</a> Heat flux</h3>\n<p>The thermodynamic forcing also follows a meridional structure and is enforced on the model’s surface through a restoring condition to the predefined annual cycle of apparent temperature, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>S</mi><msub><mi>T</mi><mi>f</mi></msub></mrow><annotation encoding=\"application/x-tex\">SST_f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> , defined as a piecewise cubic function that interpolates between the values (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>) -3, 28.3 and -30°C (corresponding index are <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">i=1,2,3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8388800000000001em;vertical-align:-0.19444em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">3</span></span></span></span>) at latitudes (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding=\"application/x-tex\">\\phi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">ϕ</span></span></span></span>) -65, 0 and 140, respectively.<br>\nSeasonal variations are added, which are<br>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϕ</mi><mi>t</mi></msub><mo>=</mo><mi>ϕ</mi><mo>+</mo><mn>3</mn><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>2</mn><mi>π</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo>−</mo><mn>0.558</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\phi_t=\\phi+3\\cos(2\\pi (t-0.558))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϕ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">ϕ</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">5</span><span class=\"mord\">5</span><span class=\"mord\">8</span><span class=\"mclose\">)</span><span class=\"mclose\">)</span></span></span></span> and<br>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub><mo>=</mo><mrow><mo fence=\"true\">{</mo><mtable rowspacing=\"0.15999999999999992em\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>y</mi><mo>−</mo><mn>0.5</mn><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>2</mn><mi>π</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo>−</mo><mn>0.558</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>i</mi><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>y</mi><mo separator=\"true\">,</mo><mi>e</mi><mi>l</mi><mi>s</mi><mi>e</mi><mi>w</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>e</mi></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">y_t=\\left\\{\\begin{matrix}\n y-0.5\\cos(2\\pi (t-0.558)),i=1 \\\\\n y,elsewhere\n\\end{matrix}\\right.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.40003em;vertical-align:-0.95003em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">{</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">5</span><span class=\"mord\">5</span><span class=\"mord\">8</span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-2.4099999999999997em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">e</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9500000000000004em;\"><span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></p>\n<div class=\"media-container\"><div class=\"player\" data-type=\"video\" data-src='[{\"name\":\"SST forcing\",\"url\":\"sst.mp4\",\"artist\":\"NeverWorld2\"}]'></div></div>\n<p>Total surface heat flux (i.e., <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mrow><mi>t</mi><mi>o</mi><mi>t</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">Q_{tot}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>, split into solar part <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mrow><mi>s</mi><mi>r</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">Q_{sr}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> and non-solar part <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mrow><mi>n</mi><mi>s</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">Q_{ns}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\">s</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>, both in <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">Wm^{-2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span>) is in proportion to <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>S</mi><msub><mi>T</mi><mi>f</mi></msub><mo>−</mo><mi>S</mi><mi>S</mi><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">SST_f-SST</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>, with SST the model’s instantaneous surface temperature. <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mrow><mi>t</mi><mi>o</mi><mi>t</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">Q_{tot}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> is defined in</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mrow><mi>t</mi><mi>o</mi><mi>t</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>ϕ</mi><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>40</mn><mo>⋅</mo><mo stretchy=\"false\">(</mo><mi>S</mi><mi>S</mi><msub><mi>T</mi><mi>f</mi></msub><mo stretchy=\"false\">(</mo><mi>ϕ</mi><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>S</mi><mi>S</mi><mi>T</mi><mo stretchy=\"false\">(</mo><mi>ϕ</mi><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>Q</mi><mrow><mi>s</mi><mi>r</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>ϕ</mi><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>+</mo><msub><mi>Q</mi><mrow><mi>n</mi><mi>s</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>ϕ</mi><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">Q_{tot}(\\phi,t) =-40\\cdot(SST_f(\\phi,t)- SST(\\phi,t))= Q_{sr}(\\phi,t)+Q_{ns}(\\phi,t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">ϕ</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span class=\"mord\">−</span><span class=\"mord\">4</span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">ϕ</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">ϕ</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">ϕ</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\">s</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">ϕ</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span></p>\n<p>where</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mrow><mi>s</mi><mi>r</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>ϕ</mi><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>230</mn><mo>⋅</mo><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>0.019</mn><mo>⋅</mo><mi>ϕ</mi><mo>−</mo><mn>0.447</mn><mo>⋅</mo><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>2</mn><mi>π</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo>−</mo><mn>0.475</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">Q_{sr}(\\phi,t)  =\\max(230\\cdot\\cos(0.019\\cdot\\phi-0.447\\cdot\\cos(2\\pi(t-0.475))),0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">ϕ</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">max</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mord\">3</span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">0</span><span class=\"mord\">1</span><span class=\"mord\">9</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">ϕ</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">4</span><span class=\"mord\">4</span><span class=\"mord\">7</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">4</span><span class=\"mord\">7</span><span class=\"mord\">5</span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span></span></span></span></p>\n<div class=\"media-container\"><div class=\"player\" data-type=\"video\" data-src='[{\"name\":\"Q sr\",\"url\":\"qsr.mp4\",\"artist\":\"NeverWorld2\"}]'></div></div>\n<h3 id=\"evaporation-minus-precipitation-emp-flux\"><a class=\"markdownIt-Anchor\" href=\"#evaporation-minus-precipitation-emp-flux\">#</a> Evaporation minus precipitation (EMP) flux</h3>\n<p>The EMP flux is purely zonal. We construct the EMP flux from piecewise cubic functions that interpolate between the values (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>) 0, -0.5, 1.1095246481, -1.2, 1, -0.5, and 0 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mi>g</mi><mi mathvariant=\"normal\">/</mi><msup><mi>m</mi><mn>2</mn></msup><mi mathvariant=\"normal\">/</mi><mi>s</mi><mi mathvariant=\"normal\">/</mi><mo stretchy=\"false\">(</mo><mn>3.16</mn><mo>∗</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>5</mn></mrow></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">Kg/m^2/s/(3.16*10^{-5})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord\">/</span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord mathnormal\">s</span><span class=\"mord\">/</span><span class=\"mopen\">(</span><span class=\"mord\">3</span><span class=\"mord\">.</span><span class=\"mord\">1</span><span class=\"mord\">6</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">5</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> at latitudes (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding=\"application/x-tex\">\\phi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">ϕ</span></span></span></span>) -75, -55, -20, 5, 30, 50, and 80, respectively.<br>\nThen we add a seasonal cycle to the EMP flux, which is<br>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub><mo>=</mo><mi>y</mi><mo>∗</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>2</mn><mi>π</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo>−</mo><mn>0.475</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">/</mi><mn>8</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">y_t=y*(1-\\cos(2\\pi(t-0.475))/8)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6597200000000001em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">4</span><span class=\"mord\">7</span><span class=\"mord\">5</span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mord\">/</span><span class=\"mord\">8</span><span class=\"mclose\">)</span></span></span></span>.</p>\n<div class=\"media-container\"><div class=\"player\" data-type=\"video\" data-src='[{\"name\":\"EMP flux\",\"url\":\"emp.mp4\",\"artist\":\"NeverWorld2\"}]'></div></div>\n<h2 id=\"ice-2\"><a class=\"markdownIt-Anchor\" href=\"#ice-2\">#</a> Ice</h2>\n<h3 id=\"wind-stress-2\"><a class=\"markdownIt-Anchor\" href=\"#wind-stress-2\">#</a> Wind stress</h3>\n<p>Set as the same as ocean.</p>\n<h3 id=\"heat-flux-2\"><a class=\"markdownIt-Anchor\" href=\"#heat-flux-2\">#</a> Heat flux</h3>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>S</mi><msub><mi>T</mi><mi>f</mi></msub></mrow><annotation encoding=\"application/x-tex\">SST_f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> is set as -1.9°C on the ice, still compare to model’s instantaneous surface temperature. <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mrow><mi>t</mi><mi>o</mi><mi>t</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">Q_{tot}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mrow><mi>n</mi><mi>s</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">Q_{ns}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\">s</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mrow><mi>s</mi><mi>r</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">Q_{sr}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> are set according to the same formula as ocean.</p>\n<h3 id=\"evaporation-minus-precipitation-emp-flux-2\"><a class=\"markdownIt-Anchor\" href=\"#evaporation-minus-precipitation-emp-flux-2\">#</a> Evaporation minus precipitation (EMP) flux</h3>\n<p>Set as the same as ocean. But <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mrow><mi>e</mi><mi>m</mi><mi>p</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">Q_{emp}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mathnormal mtight\">p</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> is set as 0 on the ice.</p>\n<h3 id=\"others\"><a class=\"markdownIt-Anchor\" href=\"#others\">#</a> Others</h3>\n<p>Snow precip and ice sublimation are set as 0 on the ice.</p>\n",
            "tags": [
                "Memo",
                "Info"
            ]
        },
        {
            "id": "https://ningchenhui.github.io/ESM/OMARE/Overlay/",
            "url": "https://ningchenhui.github.io/ESM/OMARE/Overlay/",
            "title": "OMARE Overlay",
            "date_published": "2022-09-06T12:47:52.000Z",
            "content_html": "<p>OMARE Overlay <span id=\"more\"></span></p>\n<p>JASMIN 版本要求 &gt;= 4.5.2</p>\n<h1 id=\"修改目的数据片为读写模式\"><a class=\"markdownIt-Anchor\" href=\"#修改目的数据片为读写模式\">#</a> 修改目的数据片为读写模式</h1>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>Overlayregister.h Producer.py</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Overlayregister.h\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"w\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\tf<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string\">\"/// 注册数据片通信关系\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token comment\"># U</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t<span class=\"token keyword\">for</span> field <span class=\"token keyword\">in</span> u_field_list<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\t\t\tf<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string\">\"intc->registerCoarsenPatchData(manager->\"</span><span class=\"token operator\">+</span>field<span class=\"token operator\">+</span><span class=\"token string\">\"_id,\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t\t\t\tf<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string\">\"                        \\\"\"</span><span class=\"token operator\">+</span>OVERLAY_DOUBLE_INTERP_U<span class=\"token operator\">+</span><span class=\"token string\">\"\\\",\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t\t\t\tf<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string\">\"                        manager->\"</span><span class=\"token operator\">+</span>field<span class=\"token operator\">+</span><span class=\"token string\">\"_id,\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t\t\t\tf<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string\">\"                        hier::DataAccessMode::RW);\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token comment\"># V</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t<span class=\"token keyword\">for</span> field <span class=\"token keyword\">in</span> v_field_list<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t\t\t\tf<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string\">\"intc->registerCoarsenPatchData(manager->\"</span><span class=\"token operator\">+</span>field<span class=\"token operator\">+</span><span class=\"token string\">\"_id,\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t\t\t\tf<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string\">\"                        \\\"\"</span><span class=\"token operator\">+</span>OVERLAY_DOUBLE_INTERP_V<span class=\"token operator\">+</span><span class=\"token string\">\"\\\",\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t\t\t\tf<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string\">\"                        manager->\"</span><span class=\"token operator\">+</span>field<span class=\"token operator\">+</span><span class=\"token string\">\"_id,\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t\t\t\tf<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string\">\"                        hier::DataAccessMode::RW);\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t<span class=\"token comment\"># T</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t<span class=\"token keyword\">for</span> field <span class=\"token keyword\">in</span> t_field_list<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t\t\t\tf<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string\">\"intc->registerCoarsenPatchData(manager->\"</span><span class=\"token operator\">+</span>field<span class=\"token operator\">+</span><span class=\"token string\">\"_id,\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t\t\t\tf<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string\">\"                        \\\"\"</span><span class=\"token operator\">+</span>OVERLAY_DOUBLE_INTERP_CENTER<span class=\"token operator\">+</span><span class=\"token string\">\"\\\",\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t\t\t\tf<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string\">\"                        manager->\"</span><span class=\"token operator\">+</span>field<span class=\"token operator\">+</span><span class=\"token string\">\"_id,\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t\t\t\tf<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string\">\"                        hier::DataAccessMode::RW);\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h1 id=\"fortran-实现\"><a class=\"markdownIt-Anchor\" href=\"#fortran-实现\">#</a> Fortran 实现</h1>\n<figure class=\"highlight fortran\"><figcaption data-lang=\"fortran\"><span>JASMIN_FILLGHOST.F90</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">DO</span> jc <span class=\"token operator\">=</span> jc0<span class=\"token punctuation\">,</span> jc1</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">DO</span> ic <span class=\"token operator\">=</span> ic0<span class=\"token punctuation\">,</span> ic1</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        sum_ <span class=\"token operator\">=</span> SUM<span class=\"token punctuation\">(</span>uf<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>ic<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>ratio<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span> <span class=\"token operator\">-</span>ir00<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span>ic<span class=\"token operator\">*</span>ratio<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span>ir00<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span>jc<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>ratio<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span> <span class=\"token operator\">-</span>jr00<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span>jc<span class=\"token operator\">*</span>ratio<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span>jr00<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token comment\">! coarse local index</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        ic_loc <span class=\"token operator\">=</span> ic <span class=\"token operator\">-</span> ic00 <span class=\"token operator\">+</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        jc_loc <span class=\"token operator\">=</span> jc <span class=\"token operator\">-</span> jc00 <span class=\"token operator\">+</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        uc<span class=\"token punctuation\">(</span>ic_loc<span class=\"token punctuation\">,</span> jc_loc<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> sum_ <span class=\"token operator\">/</span> <span class=\"token keyword\">REAL</span><span class=\"token punctuation\">(</span>ratio<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>ratio<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>wp<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">0.99</span> <span class=\"token operator\">+</span> uc<span class=\"token punctuation\">(</span>ic_loc<span class=\"token punctuation\">,</span> jc_loc<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">0.01</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">ENDDO</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token keyword\">ENDDO</span></pre></td></tr></table></figure>",
            "tags": [
                "Memo",
                "Coding"
            ]
        },
        {
            "id": "https://ningchenhui.github.io/ESM/OMARE/jasminInstall/",
            "url": "https://ningchenhui.github.io/ESM/OMARE/jasminInstall/",
            "title": "JASMIN 安装",
            "date_published": "2022-08-13T10:19:13.000Z",
            "content_html": "<p>JASMIN Installation <span id=\"more\"></span></p>\n<h1 id=\"所用平台\"><a class=\"markdownIt-Anchor\" href=\"#所用平台\">#</a> 所用平台</h1>\n<p>系统：Fedora 33 Workstation Edition 64 位<br>\n GCC 10.3.1 （Red Hat）</p>\n<p>此系统自带 GCC 版本过高，需安装低版本 GCC 4.8.5。</p>\n<h1 id=\"gcc-485\"><a class=\"markdownIt-Anchor\" href=\"#gcc-485\">#</a> GCC 4.8.5</h1>\n<p><span class=\"label info\"><span class=\"exturl\" data-url=\"aHR0cHM6Ly9nY2MuZ251Lm9yZy9nY2MtNC44Lw==\">下载地址</span></span></p>\n<h2 id=\"依赖安装\"><a class=\"markdownIt-Anchor\" href=\"#依赖安装\">#</a> 依赖安装</h2>\n<p>在源码文件夹中  <code>./contrib/download_prerequisites</code>  可下载好 mpfr-2.4.2，mpc-0.8.1，gmp-4.3.2，此外还需下载 isl-0.11.1，cloog-0.18.0 并解压到源码文件夹。</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> gcc-4.8.5</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">wget</span> https://gcc.gnu.org/pub/gcc/infrastructure/isl-0.11.1.tar.bz2</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">wget</span> https://gcc.gnu.org/pub/gcc/infrastructure/cloog-0.18.1.tar.gz</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">tar</span> -jxvf isl-0.11.1.tar.bz2</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">tar</span> -zxvf cloog-0.18.1.tar.gz</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">mv</span> isl-0.11.1 isl</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">mv</span> cloog-0.18.1 cloog</pre></td></tr></table></figure><h2 id=\"正常安装\"><a class=\"markdownIt-Anchor\" href=\"#正常安装\">#</a> 正常安装</h2>\n<p>为了防止出错<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNDgxMTQwODcvY29tcGlsaW5nLWdjYy00LTgtNQ==\">在源码文件夹外</span>编译安装。</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> <span class=\"token punctuation\">..</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">mkdir</span> gccbuild</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">cd</span> gccbuild</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">..</span>/gcc-4.8.5/configure --prefix<span class=\"token operator\">=</span>/usr/local/gcc-4.8.5</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">make</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">make</span> check</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">make</span> <span class=\"token function\">install</span></pre></td></tr></table></figure><p><span class=\"label info\"><span class=\"exturl\" data-url=\"aHR0cDovL25vdGVzLm1heHdpLmNvbS8yMDE3LzEyLzA5L2dudS1nY2MtY29tcGlsZS1mb3ItY2VudG9zNi8=\">参考</span></span></p>\n<h2 id=\"错误处理\"><a class=\"markdownIt-Anchor\" href=\"#错误处理\">#</a> 错误处理</h2>\n<p>用高版本 GCC 编译会出现很多不兼容问题。</p>\n<h3 id=\"stubs-32h\"><a class=\"markdownIt-Anchor\" href=\"#stubs-32h\">#</a> stubs-32.h</h3>\n<p>报错： <code>Error &quot;gnu/stubs-32.h: No such file or directory&quot; while compiling Nachos source code</code> <br>\n 处理： <code>sudo yum install glibc-devel.i686 libstdc++-devel.i686</code> <br>\n 不要加  <code>--disable-multilib</code>  编译选项绕过，会导致后面的软件编译失败。</p>\n<p><span class=\"label info\"><span class=\"exturl\" data-url=\"aHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNzQxMjU0OC9lcnJvci1nbnUtc3R1YnMtMzItaC1uby1zdWNoLWZpbGUtb3ItZGlyZWN0b3J5LXdoaWxlLWNvbXBpbGluZy1uYWNob3Mtc291cmNl\">参考</span></span></p>\n<h3 id=\"cannot-find-lstdc\"><a class=\"markdownIt-Anchor\" href=\"#cannot-find-lstdc\">#</a> Cannot find -lstdc++</h3>\n<p>处理： <code>yum install libstdc++-static glibc-static</code> <br>\n<span class=\"label info\"><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtLW1pbmluZy9ldGhtaW5lci9pc3N1ZXMvMTI0Mw==\">参考</span></span></p>\n<h3 id=\"struct-ucontext\"><a class=\"markdownIt-Anchor\" href=\"#struct-ucontext\">#</a> struct ucontext</h3>\n<p>报错： <code>dereferencing pointer to incomplete type 'struct ucontext'</code> <br>\n 处理：找到错误源码文件，将  <code>struct ucontext * uc_ = context-&gt;cfa</code>  修改为  <code>struct ucontext_t * uc_ = context-&gt;cfa</code> 。</p>\n<p><span class=\"label info\"><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3N1YWVmYXIvcnl6ZW4tdGVzdC9pc3N1ZXMvNg==\">参考</span></span></p>\n<h3 id=\"asan_linuxcc\"><a class=\"markdownIt-Anchor\" href=\"#asan_linuxcc\">#</a> asan_linux.cc</h3>\n<p>处理：在  <code>asan_linux.cc</code>  中添加头文件  <code>#include &lt;signal.h&gt;</code></p>\n<p><span class=\"label info\"><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC83NzE2NTI3MmI3ZTE=\">参考</span></span></p>\n<h3 id=\"libc_name_p\"><a class=\"markdownIt-Anchor\" href=\"#libc_name_p\">#</a> libc_name_p</h3>\n<p>报错： <code>cfns.gperf:101:1: error: ‘gnu_inline’ attribute present on ‘libc_name_p’</code> <br>\n处理：修改  <code>cfns.h</code>  中的声明和定义</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">__GNUC__</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>__inline</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span> <span class=\"token function\">libc_name_p</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>为</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">__GNUC__</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">__GNUC_STDC_INLINE__</span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">__attribute__</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>__gnu_inline__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">else</span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>__inline</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span> <span class=\"token function\">libc_name_p</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><span class=\"label info\"><span class=\"exturl\" data-url=\"aHR0cHM6Ly91bml4LnN0YWNrZXhjaGFuZ2UuY29tL3F1ZXN0aW9ucy8zMzU3MTcvaG93LXRvLWhhbmRsZS1lcnJvci1jb21waWxpbmctZ2NjLTQtNy0wLXVzaW5nLWdjYy02LTItMQ==\">参考</span></span></p>\n<h1 id=\"gdb-92\"><a class=\"markdownIt-Anchor\" href=\"#gdb-92\">#</a> GDB 9.2</h1>\n<p>由于使用旧版 gcc 时系统 gdb 不可用，需重新编译安装旧版 gdb。</p>\n<p><span class=\"label info\"><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuc291cmNld2FyZS5vcmcvZ2RiL2Rvd25sb2FkLw==\">下载地址</span></span></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">install</span> texinfo <span class=\"token operator\">!</span>编译gdb手册用</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">tar</span> zxvf  gdb-9.2.tar.gz</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">cd</span> gdb-9.2</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">mkdir</span> build</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token builtin class-name\">cd</span> build</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">..</span>/configure --disable-host-shared --prefix<span class=\"token operator\">=</span>/usr/local/gdb-9.2</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">make</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">make</span> <span class=\"token function\">install</span></pre></td></tr></table></figure><h1 id=\"netcdf-44\"><a class=\"markdownIt-Anchor\" href=\"#netcdf-44\">#</a> Netcdf 4.4</h1>\n<p><span class=\"label info\"><span class=\"exturl\" data-url=\"ZnRwOi8vZnRwLnVuaWRhdGEudWNhci5lZHUvcHViL25ldGNkZi9uZXRjZGYtNC8=\">下载地址</span></span><br>\nroot 登录，启用 GCC 4.8.5 后 <em>→参考本页环境变量配置</em></p>\n<h2 id=\"zlib-128\"><a class=\"markdownIt-Anchor\" href=\"#zlib-128\">#</a> zlib 1.2.8</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tar</span> -zxvf zlib-1.2.8.tar.gz</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">cd</span> zlib-1.2.8</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>./configure --prefix<span class=\"token operator\">=</span>/usr/local/netcdf</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">make</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">make</span> check</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">make</span> <span class=\"token function\">install</span></pre></td></tr></table></figure><h2 id=\"hdf5-1813\"><a class=\"markdownIt-Anchor\" href=\"#hdf5-1813\">#</a> hdf5 1.8.13</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tar</span> -zxvf hdf5-1.8.13.tar.gz</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">cd</span> hdf5-1.8.13</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>./configure --prefix<span class=\"token operator\">=</span>/usr/local/netcdf --with-zlib<span class=\"token operator\">=</span>/usr/local/netcdf/</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">make</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">make</span> check</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">make</span> <span class=\"token function\">install</span></pre></td></tr></table></figure><h2 id=\"netcdf-432\"><a class=\"markdownIt-Anchor\" href=\"#netcdf-432\">#</a> netcdf 4.3.2</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tar</span> -zxvf netcdf-4.3.2.tar.gz</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">cd</span> netcdf-4.3.2</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token assign-left variable\">CPPFLAGS</span><span class=\"token operator\">=</span>-I/usr/local/netcdf/include <span class=\"token assign-left variable\">LDFLAGS</span><span class=\"token operator\">=</span>-L/usr/local/netcdf/lib ./configure --prefix<span class=\"token operator\">=</span>/usr/local/netcdf --disable-dap</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">make</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">make</span> check</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">make</span> <span class=\"token function\">install</span></pre></td></tr></table></figure><h2 id=\"netcdf-fortran-440\"><a class=\"markdownIt-Anchor\" href=\"#netcdf-fortran-440\">#</a> netcdf-fortran 4.4.0</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">LD_LIBRARY_PATH</span><span class=\"token operator\">=</span>/usr/local/netcdf/lib:<span class=\"token variable\">$LD_LIBRARY_PATH</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">tar</span> -zxvf netcdf-fortran-4.4.0.tar.gz</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">cd</span> netcdf-fortran-4.4.0</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token assign-left variable\">CPPFLAGS</span><span class=\"token operator\">=</span>-I/usr/local/netcdf/include <span class=\"token assign-left variable\">LDFLAGS</span><span class=\"token operator\">=</span>-L/usr/local/netcdf/lib ./configure --prefix<span class=\"token operator\">=</span>/usr/local/netcdf</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">make</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">make</span> check</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">make</span> <span class=\"token function\">install</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">make</span> check</pre></td></tr></table></figure><p>第一次 check 可能因找不到库报错，install 后 check 通过。</p>\n<p><span class=\"label info\"><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NjaHVtYWNoZXIyMDE2L2FydGljbGUvZGV0YWlscy84MDg1MDI0MA==\">参考</span></span></p>\n<h1 id=\"jasmin-452\"><a class=\"markdownIt-Anchor\" href=\"#jasmin-452\">#</a> JASMIN 4.5.2</h1>\n<p>官网：<span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5jYWVwLXNjbnMuYWMuY24vSkFTTUlOLnBocA==\">中物院高性能数值模拟软件中心 JASMIN</span>，可申请安装包。<br>\n获得安装包后，执行  <code>sh jasmin4-4.5.2-Linux-x86_64.sh</code> ，按提示操作。<br>\n建议以版本名作为安装文件夹，如  <code>/home/ning/jasmin4-4.5.2</code> ，不选择自动更新环境变量，在下文中统一设置。<br>\n在使用 JASMIN 时需更新项目  <code>CMakeLists.txt</code>  的路径，可参考 <a href=\"/ESM/OMARE/omare220205/\">OMARE 学习使用（一）</a>。</p>\n<h1 id=\"环境变量配置\"><a class=\"markdownIt-Anchor\" href=\"#环境变量配置\">#</a> 环境变量配置</h1>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>.workenv</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token string\">\"/usr/local/gcc-4.8.5/bin:<span class=\"token environment constant\">$PATH</span>\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">LD_LIBRARY_PATH</span><span class=\"token operator\">=</span>/usr/local/gcc-4.8.5/lib64:<span class=\"token variable\">$LD_LIBRARY_PATH</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token string\">\"/usr/local/gdb-9.2/bin:<span class=\"token environment constant\">$PATH</span>\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">LD_LIBRARY_PATH</span><span class=\"token operator\">=</span>/usr/local/gdb-9.2/lib:<span class=\"token variable\">$LD_LIBRARY_PATH</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">NETCDF</span><span class=\"token operator\">=</span>/usr/local/netcdf</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token variable\">$NETCDF</span>/bin:<span class=\"token environment constant\">$PATH</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">LD_LIBRARY_PATH</span><span class=\"token operator\">=</span><span class=\"token variable\">$NETCDF</span>/lib:<span class=\"token variable\">$LD_LIBRARY_PATH</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token assign-left variable\">CPPFLAGS</span><span class=\"token operator\">=</span><span class=\"token string\">'-I/usr/local/netcdf/include'</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">LDFLAGS</span><span class=\"token operator\">=</span><span class=\"token string\">'-L/usr/local/netcdf/lib'</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token string\">\"/home/ning/jasmin4-4.5.2/bin:<span class=\"token environment constant\">$PATH</span>\"</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">'Env var loaded.'</span></pre></td></tr></table></figure><p>使用 Jasmin 前执行  <code>source .workenv</code> 。</p>\n<p>若在  <code>.bashrc</code>  中设置 gcc 变量会导致系统启动失败无法进入登录界面（ <code>F2</code>  可看到系统加载失败信息），此时需要用 Linux 系统安装 U 盘启动新系统（不安装！可在 Fedora 官网下载 U 盘写入工具）后挂载本机磁盘文件系统，修改  <code>GCC-4.8.5</code>  文件夹路径，删除  <code>.bashrc</code>  中新增的路径及  <code>/etc/ld.so.conf</code>  新增的路径，这时可以进入登录界面。移走  <code>/etc/ld.so.cache</code>  重置  <code>ldconfig</code> 。</p>\n<p>若反复卡死在登录界面可按  <code>ctrl+alt+F2</code>  命令行登入，删除追加的环境变量。在  <code>.bashrc</code>  中设置 Netcdf 的  <code>LD_LIBRARY_PATH</code>  会导致这种情况。</p>\n<h1 id=\"其他\"><a class=\"markdownIt-Anchor\" href=\"#其他\">#</a> 其他</h1>\n<h2 id=\"修改选择系统界面时间root\"><a class=\"markdownIt-Anchor\" href=\"#修改选择系统界面时间root\">#</a> 修改选择系统界面时间（root）</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">vim</span> /etc/default/grub</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>grub2-mkconfig -o <span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">$(</span>readlink -e /etc/grub2.conf<span class=\"token variable\">)</span></span>\"</span></pre></td></tr></table></figure><p><span class=\"label info\"><span class=\"exturl\" data-url=\"aHR0cHM6Ly9xYXN0YWNrLmNuL3VuaXgvMTUyMjIyL2VxdWl2YWxlbnQtb2YtdXBkYXRlLWdydWItZm9yLXJoZWwtZmVkb3JhLWNlbnRvcy1zeXN0ZW1z\">参考</span></span></p>\n<h2 id=\"samba-文件共享服务-root\"><a class=\"markdownIt-Anchor\" href=\"#samba-文件共享服务-root\">#</a> samba 文件共享服务 (root)</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9kb2NzLmZlZG9yYXByb2plY3Qub3JnL2VuLVVTL3F1aWNrLWRvY3Mvc2FtYmEv\">官方手册: How to create a Samba share</span></p>\n<p>ifconfig 查看 samba 服务 ip<br>\n 比如  <code>180.170.100.21</code> <br>\n 在 mac 访达中访问服务器  <code>smb://180.170.100.21</code> <br>\n 在 Windows 运行中访问服务器  <code>\\\\180.170.100.21</code></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NDEwNzMwL2FydGljbGUvZGV0YWlscy84MDUwMDkyMA==\">其他参考: Samba 服务器超详细安装、配置</span></p>\n<ul>\n<li>服务管理  <code>service smb stop/start/restart</code></li>\n<li>状态查看  <code>sudo smbstatus</code></li>\n</ul>\n",
            "tags": [
                "Memo"
            ]
        },
        {
            "id": "https://ningchenhui.github.io/ESM/OMARE/CoarsenOperator/",
            "url": "https://ningchenhui.github.io/ESM/OMARE/CoarsenOperator/",
            "title": "OMARE 粗化算子",
            "date_published": "2022-06-22T10:47:52.000Z",
            "content_html": "<p>OMARE CoarsenOperator <span id=\"more\"></span></p>\n<h1 id=\"新增自定义插值算子\"><a class=\"markdownIt-Anchor\" href=\"#新增自定义插值算子\">#</a> 新增自定义插值算子</h1>\n<p>参考  <code>NemoSpaceInterpCenter.h</code>  中的实现。</p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"><span>NemoSpaceMeanCenter.h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name\">NemoSpaceMeanCenter</span> <span class=\"token operator\">:</span> <span class=\"token base-clause\"><span class=\"token keyword\">public</span> xfer<span class=\"token double-colon punctuation\">::</span><span class=\"token class-name\">CoarsenOperator</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">NDIM</span><span class=\"token operator\">></span></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token function\">NemoSpaceMeanCenter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\td_name_id <span class=\"token operator\">=</span> <span class=\"token string\">\"NEMO_MEAN_INTERP\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\talpha <span class=\"token operator\">=</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">//TODO 粗化时细网格值的权重</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   * @brief 在指定的粗网格内，</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   * 将细网格片上指定的数据片插值到粗网格片上指定的数据片上.</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>   * @param fine 输入参数，Patch 类，表示细网格片.</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>   * @param coarse 输入参数，Patch 类，表示粗网格片.</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>   * @param dst_component 输入参数，整型，表示目的数据片.</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>   * @param src_component 输入参数，整型，表示源数据片.</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>   * @param  coarse_box 输入参数，Box 类，表示粗化网格.</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>   * @param ratio 输入参数，整型向量类，表示粗化比率.</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>   */</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  <span class=\"token keyword\">void</span> <span class=\"token function\">coarsen</span><span class=\"token punctuation\">(</span>hier<span class=\"token double-colon punctuation\">::</span>Patch<span class=\"token operator\">&lt;</span>NDIM<span class=\"token operator\">></span><span class=\"token operator\">&amp;</span> coarse<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> hier<span class=\"token double-colon punctuation\">::</span>Patch<span class=\"token operator\">&lt;</span>NDIM<span class=\"token operator\">></span><span class=\"token operator\">&amp;</span> fine<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>               <span class=\"token keyword\">const</span> <span class=\"token keyword\">int</span> dst_component<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">int</span> src_component<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>               <span class=\"token keyword\">const</span> hier<span class=\"token double-colon punctuation\">::</span>Box<span class=\"token operator\">&lt;</span>NDIM<span class=\"token operator\">></span><span class=\"token operator\">&amp;</span> coarse_box<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>               <span class=\"token keyword\">const</span> hier<span class=\"token double-colon punctuation\">::</span>IntVector<span class=\"token operator\">&lt;</span>NDIM<span class=\"token operator\">></span><span class=\"token operator\">&amp;</span> ratio<span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">const</span> hier<span class=\"token double-colon punctuation\">::</span>Box<span class=\"token operator\">&lt;</span>NDIM<span class=\"token operator\">></span> fine_box <span class=\"token operator\">=</span> hier<span class=\"token double-colon punctuation\">::</span><span class=\"token class-name\">Box</span><span class=\"token operator\">&lt;</span>NDIM<span class=\"token operator\">></span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">refine</span><span class=\"token punctuation\">(</span>coarse_box<span class=\"token punctuation\">,</span> ratio<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"><span>NemoFort.h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">extern</span> <span class=\"token keyword\">void</span> <span class=\"token function\">space_mean_center_</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token operator\">&amp;</span> ir00<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span><span class=\"token operator\">&amp;</span> jr00<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span><span class=\"token operator\">&amp;</span> ic00<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span><span class=\"token operator\">&amp;</span> jc00<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>                            <span class=\"token keyword\">int</span><span class=\"token operator\">&amp;</span> ir0<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span><span class=\"token operator\">&amp;</span> jr0<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span><span class=\"token operator\">&amp;</span> ir1<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span><span class=\"token operator\">&amp;</span> jr1<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>                            <span class=\"token keyword\">int</span><span class=\"token operator\">&amp;</span> ic0<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span><span class=\"token operator\">&amp;</span> jc0<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span><span class=\"token operator\">&amp;</span> ic1<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span><span class=\"token operator\">&amp;</span> jc1<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>                            <span class=\"token keyword\">int</span><span class=\"token operator\">&amp;</span> jpir<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span><span class=\"token operator\">&amp;</span> jpjr<span class=\"token punctuation\">,</span> <span class=\"token keyword\">double</span><span class=\"token operator\">*</span> ur<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                            <span class=\"token keyword\">int</span><span class=\"token operator\">&amp;</span> jpic<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span><span class=\"token operator\">&amp;</span> jpjc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">double</span><span class=\"token operator\">*</span> uc<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                            <span class=\"token keyword\">int</span><span class=\"token operator\">*</span> ratio<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h1 id=\"fortran-实现\"><a class=\"markdownIt-Anchor\" href=\"#fortran-实现\">#</a> Fortran 实现</h1>\n<figure class=\"highlight fortran\"><figcaption data-lang=\"fortran\"><span>JASMIN_FILLGHOST.F90</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">SUBROUTINE</span> space_mean_center<span class=\"token punctuation\">(</span> ir00<span class=\"token punctuation\">,</span> jr00<span class=\"token punctuation\">,</span> ic00<span class=\"token punctuation\">,</span> jc00<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&amp;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>                                ir0<span class=\"token punctuation\">,</span> jr0<span class=\"token punctuation\">,</span> ir1<span class=\"token punctuation\">,</span> jr1<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&amp;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>                                ic0<span class=\"token punctuation\">,</span> jc0<span class=\"token punctuation\">,</span> ic1<span class=\"token punctuation\">,</span> jc1<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&amp;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>                                jpir<span class=\"token punctuation\">,</span> jpjr<span class=\"token punctuation\">,</span> uf<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&amp;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                                jpic<span class=\"token punctuation\">,</span> jpjc<span class=\"token punctuation\">,</span> uc<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&amp;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                                ratio<span class=\"token punctuation\">)</span> bind<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"space_mean_center_\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token comment\">! input &amp; output            </span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">INTEGER</span><span class=\"token punctuation\">,</span>                        <span class=\"token keyword\">INTENT</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">in</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">::</span>   ir00<span class=\"token punctuation\">,</span> jr00<span class=\"token punctuation\">,</span> ic00<span class=\"token punctuation\">,</span> jc00      <span class=\"token comment\">!patch lower index (ghost included)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">INTEGER</span><span class=\"token punctuation\">,</span>                        <span class=\"token keyword\">INTENT</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">in</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">::</span>   ir0<span class=\"token punctuation\">,</span> jr0<span class=\"token punctuation\">,</span> ir1<span class=\"token punctuation\">,</span> jr1          <span class=\"token comment\">!refine box start/end index</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">INTEGER</span><span class=\"token punctuation\">,</span>                        <span class=\"token keyword\">INTENT</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">in</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">::</span>   ic0<span class=\"token punctuation\">,</span> jc0<span class=\"token punctuation\">,</span> ic1<span class=\"token punctuation\">,</span> jc1          <span class=\"token comment\">!coarse box start/end index</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">INTEGER</span><span class=\"token punctuation\">,</span>                        <span class=\"token keyword\">INTENT</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">in</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">::</span>   jpir<span class=\"token punctuation\">,</span> jpjr                  <span class=\"token comment\">!refine patch size (ghost included)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">REAL</span><span class=\"token punctuation\">(</span>wp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">DIMENSION</span><span class=\"token punctuation\">(</span>jpir<span class=\"token punctuation\">,</span>jpjr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">INTENT</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">in</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">::</span>   uf                          <span class=\"token comment\">!refine patch data</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">INTEGER</span><span class=\"token punctuation\">,</span>                        <span class=\"token keyword\">INTENT</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">in</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">::</span>   jpic<span class=\"token punctuation\">,</span> jpjc                  <span class=\"token comment\">!coarse patch size (ghost included)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">REAL</span><span class=\"token punctuation\">(</span>wp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">DIMENSION</span><span class=\"token punctuation\">(</span>jpic<span class=\"token punctuation\">,</span>jpjc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">INTENT</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">inout</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">::</span>   uc                       <span class=\"token comment\">!coarse patch data</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">INTEGER</span><span class=\"token punctuation\">,</span>  <span class=\"token keyword\">DIMENSION</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>         <span class=\"token keyword\">INTENT</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">in</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">::</span>   ratio                       <span class=\"token comment\">!x refinement ratio NDIM?</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token comment\">! local</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">INTEGER</span> <span class=\"token operator\">::</span> ic<span class=\"token punctuation\">,</span> jc</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">INTEGER</span> <span class=\"token operator\">::</span> ic_loc<span class=\"token punctuation\">,</span> jc_loc</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">REAL</span><span class=\"token punctuation\">(</span>wp<span class=\"token punctuation\">)</span> <span class=\"token operator\">::</span> sum_</pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">DO</span> jc <span class=\"token operator\">=</span> jc0<span class=\"token punctuation\">,</span> jc1</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">DO</span> ic <span class=\"token operator\">=</span> ic0<span class=\"token punctuation\">,</span> ic1</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        sum_ <span class=\"token operator\">=</span> SUM<span class=\"token punctuation\">(</span>uf<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>ic<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>ratio<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span> <span class=\"token operator\">-</span>ir00<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span>ic<span class=\"token operator\">*</span>ratio<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span>ir00<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span>jc<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>ratio<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span> <span class=\"token operator\">-</span>jr00<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span>jc<span class=\"token operator\">*</span>ratio<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span>jr00<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token comment\">! coarse local index</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        ic_loc <span class=\"token operator\">=</span> ic <span class=\"token operator\">-</span> ic00 <span class=\"token operator\">+</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        jc_loc <span class=\"token operator\">=</span> jc <span class=\"token operator\">-</span> jc00 <span class=\"token operator\">+</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        uc<span class=\"token punctuation\">(</span>ic_loc<span class=\"token punctuation\">,</span> jc_loc<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> sum_ <span class=\"token operator\">/</span> <span class=\"token keyword\">REAL</span><span class=\"token punctuation\">(</span>ratio<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>ratio<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>wp<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">ENDDO</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token keyword\">ENDDO</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token keyword\">END SUBROUTINE</span> space_mean_center</pre></td></tr></table></figure><h1 id=\"启用-overlay\"><a class=\"markdownIt-Anchor\" href=\"#启用-overlay\">#</a> 启用 Overlay</h1>\n<p>这里  <code>sync_time % 1 != 0</code>  的  <code>1</code>  改为 Overlay 的步长。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"><span>NemoLevelIntegrator_body.C Producer.py</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/****************************************************************</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> * AMR, 同步粗网格层.</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> *****************************************************************/</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">void</span> NemoLevelIntegrator<span class=\"token operator\">::</span><span class=\"token function\">synchronizeCoarserLevel</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token keyword\">const</span> JASMIN<span class=\"token operator\">::</span>tbox<span class=\"token operator\">::</span>Pointer<span class=\"token operator\">&lt;</span>JASMIN<span class=\"token operator\">::</span>hier<span class=\"token operator\">::</span>BasePatchHierarchy<span class=\"token operator\">&lt;</span>NDIM<span class=\"token operator\">>></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    hierarchy<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token keyword\">const</span> <span class=\"token keyword\">int</span> finer_level_number<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">double</span> sync_time<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token keyword\">const</span> <span class=\"token keyword\">double</span> coarser_old_time<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  using namespace std<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  using namespace JASMIN<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span>sync_time <span class=\"token operator\">%</span> <span class=\"token number\">1</span> <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  tbox<span class=\"token operator\">::</span>pout<span class=\"token operator\">&lt;&lt;</span><span class=\"token string\">\"***********************************************\"</span><span class=\"token operator\">&lt;&lt;</span>endl<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  tbox<span class=\"token operator\">::</span>pout<span class=\"token operator\">&lt;&lt;</span><span class=\"token string\">\"Synchronize (Overlay) Coarser Level... \"</span><span class=\"token operator\">&lt;&lt;</span>endl<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  tbox<span class=\"token operator\">::</span>pout<span class=\"token operator\">&lt;&lt;</span><span class=\"token string\">\"     finer_level_number==\"</span><span class=\"token operator\">&lt;&lt;</span>finer_level_number<span class=\"token operator\">&lt;&lt;</span>endl<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  tbox<span class=\"token operator\">::</span>pout<span class=\"token operator\">&lt;&lt;</span><span class=\"token string\">\"     sync_time==\"</span><span class=\"token operator\">&lt;&lt;</span>sync_time<span class=\"token operator\">&lt;&lt;</span>endl<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  tbox<span class=\"token operator\">::</span>pout<span class=\"token operator\">&lt;&lt;</span><span class=\"token string\">\"     coarser_old_time==\"</span><span class=\"token operator\">&lt;&lt;</span>coarser_old_time<span class=\"token operator\">&lt;&lt;</span>endl<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  tbox<span class=\"token operator\">::</span>pout<span class=\"token operator\">&lt;&lt;</span><span class=\"token string\">\"***********************************************\"</span><span class=\"token operator\">&lt;&lt;</span>endl<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  <span class=\"token comment\">// 校正相邻粗网格层的通量</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>  tbox<span class=\"token operator\">::</span>Pointer<span class=\"token operator\">&lt;</span>hier<span class=\"token operator\">::</span>PatchLevel<span class=\"token operator\">&lt;</span>NDIM<span class=\"token operator\">>></span> finer_level <span class=\"token operator\">=</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    hierarchy<span class=\"token operator\">-></span><span class=\"token function\">getPatchLevel</span><span class=\"token punctuation\">(</span>finer_level_number<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>  tbox<span class=\"token operator\">::</span>Pointer<span class=\"token operator\">&lt;</span>hier<span class=\"token operator\">::</span>PatchLevel<span class=\"token operator\">&lt;</span>NDIM<span class=\"token operator\">>></span> coarser_level <span class=\"token operator\">=</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    hierarchy<span class=\"token operator\">-></span><span class=\"token function\">getPatchLevel</span><span class=\"token punctuation\">(</span>finer_level_number <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>  <span class=\"token keyword\">const</span> <span class=\"token keyword\">double</span> actual_dt <span class=\"token operator\">=</span> sync_time <span class=\"token operator\">-</span> coarser_old_time<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>  <span class=\"token comment\">// 细网格 -> 粗网格 (具体方法在初始化构件中)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>  sync_overlay_intc<span class=\"token operator\">-></span><span class=\"token function\">synchronizeCoarserLevel</span><span class=\"token punctuation\">(</span>finer_level<span class=\"token punctuation\">,</span> sync_time<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h1 id=\"注册使用插值算子的变量\"><a class=\"markdownIt-Anchor\" href=\"#注册使用插值算子的变量\">#</a> 注册使用插值算子的变量</h1>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>Producer.py var_db.py</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>OVERLAY_DOUBLE_INTERP_CENTER <span class=\"token operator\">=</span> <span class=\"token string\">\"NEMO_MEAN_INTERP\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>t_field_list <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token string\">\"tsn\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"tsb\"</span><span class=\"token punctuation\">,</span> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token string\">\"sshn\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"sshb\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token string\">\"avm_k\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Overlayregister.h\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"w\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token comment\"># T</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token keyword\">for</span> field <span class=\"token keyword\">in</span> t_field_list<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string\">\"intc->registerCoarsenPatchData(manager->\"</span><span class=\"token operator\">+</span>field<span class=\"token operator\">+</span><span class=\"token string\">\"_id,\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string\">\"                        \\\"\"</span><span class=\"token operator\">+</span>OVERLAY_DOUBLE_INTERP_CENTER<span class=\"token operator\">+</span><span class=\"token string\">\"\\\",\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string\">\"                        manager->\"</span><span class=\"token operator\">+</span>field<span class=\"token operator\">+</span><span class=\"token string\">\"_id);\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><figure class=\"highlight c\"><figcaption data-lang=\"c\"><span>main_Nemo.C</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"NemoSpaceMeanCenter.h\"</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">// add user-define sapce refine operator</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>tbox<span class=\"token operator\">::</span>Pointer<span class=\"token operator\">&lt;</span>JASMIN<span class=\"token operator\">::</span>pdat<span class=\"token operator\">::</span>NemoSpaceMeanCenter<span class=\"token operator\">></span> nemo_space_mean_center_operator</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token operator\">=</span> new JASMIN<span class=\"token operator\">::</span>pdat<span class=\"token operator\">::</span><span class=\"token function\">NemoSpaceMeanCenter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>grid_geometry<span class=\"token operator\">-></span><span class=\"token function\">addSpatialCoarsenOperator</span><span class=\"token punctuation\">(</span>nemo_space_mean_center_operator<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h1 id=\"与-conservative_coarsen-比较\"><a class=\"markdownIt-Anchor\" href=\"#与-conservative_coarsen-比较\">#</a> 与 “CONSERVATIVE_COARSEN” 比较</h1>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>h5diff omare_mean/build/exp_l2/javis_dump.00006/processor_cluster.00000.jasmin omare_220608/build/exp_l2/javis_dump.00006/processor_cluster.00000.jasmin</pre></td></tr></table></figure><pre><code>size:           [2400]           [2400]\nposition        sshn            sshn            difference          \n------------------------------------------------------------\n[ 900 ]          6.04414e-07     6.04414e-07     5.68434e-14    \n1 differences found\ndataset: &lt;/processor.00000/level.00001/patch.00000/un.38&gt; and &lt;/processor.00000/level.00001/patch.00000/un.38&gt;\nsize:           [15000]           [15000]\nposition        un.38           un.38           difference          \n------------------------------------------------------------\n[ 145 ]          -1.00591e-05    -1.00591e-05    9.09495e-13    \n[ 210 ]          -1.2723e-06     -1.2723e-06     1.13687e-13    \n[ 1985 ]          -8.53e-07       -8.53e-07       5.68434e-14    \n[ 2438 ]          -1.50793e-05    -1.50793e-05    9.09495e-13    \n</code></pre>\n<p>加上  <code>1e-10</code>  的限制后只有 14 个差异值。</p>\n<h2 id=\"sshn\"><a class=\"markdownIt-Anchor\" href=\"#sshn\">#</a> sshn</h2>\n<p class=\"gallery\" data-height=\"400\"><img data-src=\"0608.png\" alt=\"\" title=\"jasmin\"><br>\n<img data-src=\"mean.png\" alt=\"mean\"><br>\n<img data-src=\"bug.png\" alt=\"赋0\"></p>\n",
            "tags": [
                "Memo",
                "Coding"
            ]
        },
        {
            "id": "https://ningchenhui.github.io/ESM/OMARE/omare220205/",
            "url": "https://ningchenhui.github.io/ESM/OMARE/omare220205/",
            "title": "OMARE 学习使用（一）",
            "date_published": "2022-02-05T11:19:13.000Z",
            "content_html": "<p>Learn to run OMARE（i）<span id=\"more\"></span></p>\n<p>step 1 - 解压源代码后，在目录里创建  <code>build</code>  文件夹<br>\n step 2 - 修改文件中的路径</p>\n<pre><code>a. CMakeLists.txt\n  set(JASMIN_VERSION 新路径)\n  debug 行运行时注释掉，调试时开启\nb. input/GYRE/namelist_cfg (之后可以在build中改)\n  nn_GYRE  resolution\n</code></pre>\n<p>step 3 - 进入  <code>build</code>  文件夹，执行  <code>~/jasmin4/bin/cmake ../</code> <br>\nstep 4 - 执行  <code>make</code>  ( <code>make -j 50</code>  多线程)<br>\nstep 5 -  <code>./main2d ../input/nemo-2d.input</code>   运行不完 / 测试时可  <code>ctrl+c</code>  中止<br>\n step 6 -  <code>ctrl+r</code>   <code>teravap</code>  查看数据 （ <code>/usr/local/teravap/teravap2_2_0.linux- x86_64/bin/teravap</code> ）<br>\n         数据在  <code>./build/javis../dumps.javis</code>  中，打开后 Add - Mesh , Draw。更换数据需要重启。</p>\n<p>修改完 h 文件后执行 step 4</p>\n<p>虚拟机 mpi 运行</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>mpirun -n <span class=\"token number\">4</span> ./main2d <span class=\"token punctuation\">..</span>/input/nemo-2d.input</pre></td></tr></table></figure><p>运行步数在  <code>nemo-2d.input</code>  里改， <code>namelist</code>  里无效。</p>\n<p>使用 gdb 调试时 Fortran 的代码行是混乱的，用 watch 下断点。</p>\n<p>gdb 调试方法参考 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dhbmdxaWppbnlhL2FydGljbGUvZGV0YWlscy8xMDE1NTkzODY=\">这篇博客</span>。</p>\n<p>调试例子</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>b NemoSpaceMeanCenter :: coarsen</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>b postprocessCoarsenOperator</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">set</span> args <span class=\"token punctuation\">..</span>/input/nemo-2d.input</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>r</pre></td></tr></table></figure><p>对于 shared_ptr</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>p fdata</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token variable\">$3</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token operator\">&lt;</span>boost::shared_ptr<span class=\"token operator\">&lt;</span>JASMIN::pdat::CellData<span class=\"token operator\">&lt;</span><span class=\"token number\">2</span>, double<span class=\"token operator\">></span> <span class=\"token operator\">>></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>px <span class=\"token operator\">=</span> 0x9a95ed0, pn <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>      pi_ <span class=\"token operator\">=</span> 0x9a96460<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span>, <span class=\"token operator\">&lt;</span>No data fields<span class=\"token operator\">></span><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>使用如下命令查看。</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>p <span class=\"token variable\"><span class=\"token punctuation\">((</span>JASMIN<span class=\"token operator\">:</span><span class=\"token operator\">:</span>pdat<span class=\"token operator\">:</span><span class=\"token operator\">:</span>CellData<span class=\"token operator\">&lt;</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>double<span class=\"token operator\">></span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>fdata<span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span>getDepth<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>p <span class=\"token operator\">*</span><span class=\"token punctuation\">((</span><span class=\"token punctuation\">(</span>JASMIN<span class=\"token operator\">:</span><span class=\"token operator\">:</span>pdat<span class=\"token operator\">:</span><span class=\"token operator\">:</span>CellData<span class=\"token operator\">&lt;</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>double<span class=\"token operator\">></span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>fdata<span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span>getPointer<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">40</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>p <span class=\"token operator\">*</span><span class=\"token punctuation\">((</span><span class=\"token punctuation\">(</span>JASMIN<span class=\"token operator\">:</span><span class=\"token operator\">:</span>pdat<span class=\"token operator\">:</span><span class=\"token operator\">:</span>CellData<span class=\"token operator\">&lt;</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>double<span class=\"token operator\">></span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>coarse.getPatchData<span class=\"token punctuation\">(</span>manager<span class=\"token operator\">-</span><span class=\"token operator\">></span>sshn_id<span class=\"token punctuation\">))</span></span>-<span class=\"token operator\">></span>getPointer<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>+400<span class=\"token punctuation\">)</span></pre></td></tr></table></figure>",
            "tags": [
                "Memo",
                "Coding"
            ]
        }
    ]
}